OpenVAS Vulnerability Scanner Deployment (Greenbone Community Edition)

- Author: Ty Iorfino
- Date: October 2025  
- Tools Used: OpenVAS (Greenbone Vulnerability Manager), Docker, Ubuntu 24.04.3 LTS, Greenbone Community Container, GSA Web UI  

---

Project Overview
- This project documents how I deployed and configured the Greenbone Community Edition (OpenVAS) vulnerability scanner inside a Proxmox virtual machine running Ubuntu 24.04.3 LTS.  
- My goal was to perform both network-wide and credentialed scans to identify vulnerabilities across my home subnet and a specific Windows target.  
- After performing these scans, I analyzed the reports, applied security patches, and verified improvements through follow-up assessments.

---

Tools 
- OpenVAS / GVM: Core vulnerability scanning and management engine 
- Greenbone Community Container: Containerized deployment of GVM services 
- Docker / Docker Compose: Service orchestration and management 
- Ubuntu 24.04.3 LTS: Host operating system (Proxmox VM) 
- Greenbone Security Assistant (GSA): Web UI for scan configuration and reporting 
- SMB / WinRM Credentials: Authentication for Windodws

---

System Specifications
-Virtualization Platform: Proxmox VE 9.0.3
- Guest OS: Ubuntu 24.04.3 LTS 
- CPU: 4 vCores 
- Memory: 23.4 GiB 
- Storage: 60 GB qcow2 disk 
- Network Interface: VirtIO bridged via `vmbr0` 
- Bridge Configuration:  `vmbr0` for LAN (192.168.1.0/24)

---

Deployment Steps
1) Create The Proxmox VM
- I created a new VM in Proxmox using the Ubuntu 24.04.3 Desktop ISO image.  
- I configured it with 4 virtual cores, 24 GiB of RAM, and 60 GB of storage.  
- Instead of using Proxmox helper scripts, I manually installed Ubuntu from the ISO.  
- The VMâ€™s network interface was bridged via `vmbr0`, allowing it to access my LAN.
<p align="center">
   <img src="https://github.com/user-attachments/assets/91058b6a-6f2f-4144-b3c1-5c59b5d153c6" alt="Screenshot 2025-10-20 131740" width="600" height="300">
</p>

---

2) Install Greenbone Community Edition
- Inside the Ubuntu VM, I followed the official Greenbone Community documentation for Docker deployment:  
   (https://greenbone.github.io/docs/latest/)  
- Then I used the Greenbone installation scripts to deploy containers for:  
  - Greenbone Vulnerability Manager (GVM)  
  - OpenVAS Scanner  
  - PostgreSQL database  
  - Greenbone Security Assistant (GSA) Web UI  
- After installation I started all containers by running:
  - docker compose up 
(It takes some time for all feeds to synchronize)
<p align="center">
  <img src="https://github.com/user-attachments/assets/4424198b-4545-47d5-b8bc-1ce0f688a3f3" alt="Screenshot 2025-10-20 135346" width="600" height="300">
</p>

---

3) Accessing the Greenbone GUI
- Once all containers were finished starting up, I accessed the GUI by utilizing Ubuntus firefox brower and going to http:\\127.0.0.1:9392.
  - To find this IP I used the command: "ip addr show", this showed me my ip to connect to the GUI and also allowed me to make sure the VM was on the same subnet as my devices for a proper scan.
- I then made sure that all feed statuses were up to date, to do this go to Administration -> Feed Status, ensure all statuses say "current", or arent too old.
<p align="center">
  <img src="https://github.com/user-attachments/assets/1f37db8c-de1e-4248-9760-ee6b43e26237" alt="Screenshot 2025-10-20 095541" width="600" height="300">
  <img src="https://github.com/user-attachments/assets/65532b78-eefe-4a8c-80ac-3a2f97534ed8" alt="Screenshot 2025-10-20 131829" width="600" height="300">
</p>

---

4) Creating Scan Targets
- I created two separate scan targets under Configuration -> Targets:
  - 1st Target: Subnet scan, scanning 192.168.1.0/24 - to discover and scan all devices on my local network.
  - 2nd Target: Single host scan, a single Windows IP address scan on my LAN (192.168.1.xxx).
<p align="center">
   <img src="https://github.com/user-attachments/assets/71637299-e87b-4eda-99bd-ff28ab3ce34b" alt="Screenshot 2025-10-20 135725" width="600" height="300">
</p>

---

5) Configuring SMB Credentials for single host scan
- For the single host Windows target, I created a set of SMB credentials named winAuth. To do this go to Configuration -> Credentials -> New Credentials.
- This allowed the scanner do an authenticated scan for deeper checks against the Windows system.
- I attached these credentials to the single-host target so that the scan would perform authenticated checks.
<p align="center">
   <img src="https://github.com/user-attachments/assets/ea91d3b3-9855-4145-b77a-4d972984fd2e" alt="Screenshot 2025-10-20 135809" width="600" height="300">
</p>

---

6) Creating and Running Scan Tasks
- Next, I created two scan tasks under Scans -> Tasks -> New Task.
  - 1st Task: LAN discovery using Full & Fast scan config - targeting the entire subnet using the default scanner, not authenticated.
  - 2nd Task: Windows Scan using Full & Fast scan config - targeting the single Windows host using the default scanner, with authenticated 'winAuth' credentials attached.
- Then I started the scans and monitored their progress through using "docker compose up" for any errors.
<p align="center">
  <img src="https://github.com/user-attachments/assets/6c21c418-3714-4def-82b7-e2e9d6ed799c" alt="Screenshot 2025-10-20 144240" width="600" height="300">
  <img src="https://github.com/user-attachments/assets/59654a39-55a5-49d1-afad-b159dabc4ed9" alt="Screenshot 2025-10-20 144211" width="600" height="300">
</p>


---

7) Reviewing Scan Results and Exporting Reports
- Once both scans were completed, I examined the results by going to Scans -> Reports.
- I exported each report as a PDF, creating a local audit record of the vulnerabilities found and how to fix them.
<p align="center">
  <img src="https://github.com/user-attachments/assets/c80b29a1-ec83-4283-bb0c-a0f3f7c6375a" alt="Screenshot 2025-10-20 150317" width="600" height="300">
  <img src="https://github.com/user-attachments/assets/9eee8251-12f8-4e72-a1fe-1b5cfea55b2e" alt="Screenshot 2025-10-20 141815" width="600" height="300">
</p>

---

8) Applying Patches and Re-Scanning
- Using the report, I identified all high-severity vulnerabilities on the Windows host.
- I applied Windows updates and software updates on the system and affected application, then re-ran a credentialed scan.
- The second scan showed a reduction in high and medium-severity issues, showing successful remediation.
<p align="center">
   <img src="https://github.com/user-attachments/assets/8c04884c-8e6d-4886-9381-2cbc5722d091" alt="Screenshot 2025-10-20 150639" width="600" height="300">
</p>

---

9) Final Observations
- After reviewing the final report, I noticed all of the remaining high severity issues was caused by an end of life vulnerabilities, which I couldnt update becasue they are dependecies applications use, aslong as these process remain local then they serve minimal risk.
- The overall system risk score decreased significantly, and there were a lot less vulnerabilities of all severity types.

---

References
- [Greenbone Community Documentation](https://greenbone.github.io/docs/latest/)  
- [Greenbone Docker Deployment Guide](https://greenbone.github.io/docs/latest/22.4/container/index.html)  
- [Proxmox VE Documentation](https://pve.proxmox.com/wiki/Main_Page)

---

Issues During Deployment
- I noticed that my Windows computer was not responding to pings, Nmap scans, or credential scans due to Windows firewall rules, so I had to temporarily edit my firewall rules in "windows defender firewall with advanced security" and then reinstate them after the scans were done.
  - I had to enable TCP ports 139 and 445 and UDP ports 137-138 and 5355 and lastly ICMPv4/ICMPv6 protocols (NetBIOS,SMB,LLMNR,echo requests).
<p align="center">
   <img src="https://github.com/user-attachments/assets/d54ab41a-10a6-498c-b8be-4affc1a3497c" alt="Screenshot 2025-10-18 125427" width="600" height="300">
   <img src="https://github.com/user-attachments/assets/f2105b43-981e-47b4-be03-5b4935f18c6a" alt="Screenshot 2025-10-18 124608" width="600" height="300">
   <img src="https://github.com/user-attachments/assets/97a8e9de-ff34-42b3-a16b-6115b41b9d07" alt="Screenshot 2025-10-18 125340" width="600" height="300">
   <img src="https://github.com/user-attachments/assets/010620eb-43ea-48d5-8e81-b22fcd252340" alt="Screenshot 2025-10-18 124608" width="600" height="300">
</p>

- I checked to see if all these processes were working, including if my credentials were valid by using "smbclient" command:
  - smbclient -L //192.168.1.84 -U gvm-scan
<p align="center">
   <img src="https://github.com/user-attachments/assets/5cec205e-2078-44a8-bfa9-718f83cd0c34" alt="e7b6d35c-7c7a-4586-aee1-f7f18400d2d5" width="600" height="300">
</p>

- Some of the services were not running, so I manually started them using this code in an elevated command prompt:
  - Start-Service -Name LanmanServer
    Start-Service -Name Winmgmt
    Start-Service -Name RemoteRegistry

- After configuring the firewall and starting the required services, my Nmap and ping scans started to work, proving the computers were communicating.
<p align="center">
   <img src="https://github.com/user-attachments/assets/47645f15-d86b-48fe-b8c6-3df5d097ebe1" alt="4e625fb9-9b2e-4c77-b96b-2d0760e5363f" width="600" height="300">
   <img src="https://github.com/user-attachments/assets/b2878494-7c98-4a87-abba-71ad560f59db" alt="Screenshot 2025-10-19 141059" width="600" height="300">
</p>



























